# 자바스크립트 변수와 데이터 타입

> 데이터를 담는 공간

## 변수의 범위

- 전역 변수

  ```javascript
  var variable1 = 'javascript';
  ```

  프로젝트 전체에서 사용되는 변수

  ```javascript
  function fn1() {
      variable2 = 'html5';
  }
  
  fn1();
  console.log(variable2); // html5
  ```

  `var`키워드를 사용하지 않고 함수 내부에서 변수를 선언하는 경우 **전역 변수**이다.

- 지역 변수

  ```javascript
  function fn2() {
      var variable3 = 'css3';
      console.log(variable3); // css3
  }
  
  fn2();
  console.log(variable3); // Uncaught ReferenceError: variable3 is not defined
  ```

- `var` 키워드에 관한 핵심은 해당 변수의 범위가 가장 가까운 함수라는 것

  ```javascript
  function fn3(print) {
      if ( print ) {
          var insideIf = '12';
      }
      console.log(insideIf);
  }
  
  fn3(true); // 12
  ```

  위의 함수는 다음 함수와 동일하다.

  ```javascript
  function fn3(print) {
      var insideIf;
      if ( print ) {
          insideIf = '12';
      }
      console.log(insideIf);
  }
  
  fn3(true); // 12
  ```

  ```javascript
  var a = 1;
  function fn4() {
      if ( true ) {
          var a = 4;
      }
      console.log(a); // 4
  }
  ```

  스코프 체인에 의해서 전역 변수(a)가 아닌 지역 변수(a)가 출력된다.

## 변수의 선언

> 어떤 공간에 어떤 값을 저장하기 위한 이름을 가진 공간

- 변수는 `var`, `let`, `const`로 선언할 수 있다.

  ```javascript
  var a = 2;
  let b = 3;
  const c = 4;
  ```

- 키워드에 따라 재할당 가능 여부도 달라진다.

  ```javascript
  // var
  var str = 'hello';
  str = 'world';
  ```

  ```javascript
  // let
  let str = 'hello';
  str = 'world'; // Uncaught SyntaxError: Identifier 'str' has already been declared
  ```

- 키워드에 따라 변수의 유효 범위가 달라진다.

  ```javascript
  // var
  for(var i = 0; i < 10; i++) {
      console.log(i);
  }
  
  console.log(i); // 10
  ```

  `var` 키워드는 블록 스코프가 아닌 **함수 스코프**를 가진다.

  ```javascript
  // let
  for(let i = 0; i < 10; i++) {
      console.log(i);
  }
  
  console.log(i); // Uncaught ReferenceError: i is not defined
  ```

  `let`키워드는 블록 스코프를 가지므로 블록내에서만 유효하다.

- 변수 선언에는 호이스팅이라는 메커니즘이 존재한다.

  ```javascript
  console.log(a); // undefined
  var a = 10;
  console.log(a); // 10
  ```

  선언 전에  변수를 출력했으므로 오류가 나야 일반적이겠지만 그렇게 작동하지 않는다. 해당 코드는 자바스크립트 엔진에 의해 아래와 같은 코드로 변경된다.

  ```javascript
  var a; // 선언만 하면 엔진은 해당 값을 undefined로 초기화한다.
  console.log(a); // undefined
  a = 10;
  console.log(a); // 10
  ```

  해당 코드를 보니 왜 2번째 줄의 콘솔에서 `undefined`가 나오는지 이해할 수 있게 된다. 호이스팅에 의해 변수 선언은 상단으로 끌어올려(hosting)진다. 그래서 대부분 코드에서 변수는 상단에 선언되어있는 것을 확인할 수 있다.

- `const`는 상수이다.

  ```javascript
  const a = 10;
  a = 20; // Uncaught TypeError: Assignment to constant variable
  ```

  하지만, 객체나 배열 내부는 변경할 수 있다.

  ```javascript
  const a = {};
  a.num = 10;
  console.log(a); // { num: 10 }
  
  const b = [];
  b.push(20);
  console.log(b); // [20]
  ```

## 혼란스러운 상황

이벤트 리스너에서 `i` 변수를 사용하는 경우

```html
<div class="container">
	<button class="btn">0</button>
	<button class="btn">1</button>
	<button class="btn">2</button>
</div>
```

```javascript
var btnList = document.querySelectorAll('.btn');

for ( var i = 0; i < btnList.length; i++ ) {
    btnList[i].addEventListener('click', function () {
        console.log('click', i); // 3
    });
}
```

차례대로 `0, 1, 2`가 나올 것으로 예상하지만 실제로는 `3, 3, 3`이 나온다. 해결하는 방법은 3가지 정도가 존재한다.

1. ```javascript
   var btnList = document.querySelectorAll('.btn');
   
   for ( let i = 0; i < btnList.length; i++ ) {
       btnList[i].addEventListener('click', function () {
           console.log('click', i); // 1, 2, 3
       });
   }
   ```

2. ```javascript
   var btnList = document.querySelectorAll('.btn');
   
   for ( var i = 0; i < btnList.length; i++ ) {
       (function (idx) {
           btnList[idx].addEventListener('click', function () {
               console.log('click', idx);
           });
       })(i)
   }
   ```

3. ```javascript
   var btnList = document.querySelectorAll('.btn');
   
   for ( var i = 0; i < btnList.length; i++ ) {
   	event(i);
   }
   
   function event(idx) {
   	btnList[idx].addEventListener('click', function () {
   		console.log('click', idx);
   	});
   }
   ```

## 데이터 타입

- 원시 타입

  - 숫자 (number)

    ```javascript
    var num = 10;
    ```

  - 문자열 (string)

    ```javascript
    var str = 'hello world';
    ```

  - 불린 (boolean)

    ```javascript
    var bool = true;
    ```

  - undefined

    ```javascript
    var a; // undefined
    ```

  - null

    ```javascript
    var b = null;
    ```

  - Symbol(ES6에서 새로 추가된 원시 타입)

    ```javascript
    var arr = [1, 2, 3];
    arr[Symbol.iterator];
    ```

    

- 참조 타입

  - 객체 (object)

    - 배열 (array)

      ```javascript
      var arr = [1, 2, 3];
      ```

    - 함수 (function)

      ```javascript
      function a() {}
      ```

    - 정규식 (regexp)

      ```javascript
      var regex = new RegExp('');
      ```

    - 날짜 (date)

      ```javascript
      var date = new Date();
      ```

- 데이터 타입 검사하기

  ```javascript
  var num = 10;
  console.log(typeof num); // number
  
  var str = 'hello world';
  console.log(typeof str); // string
  
  var bool = true;
  console.log(typeof bool); // boolean
  ```

## 참고한 것

-  https://gmlwjd9405.github.io/2019/04/18/javascript-variable-and-type.html
-  https://www.bsidesoft.com/?p=4154